{"remainingRequest":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/thread-loader/dist/cjs.js!/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/eslint-loader/index.js??ref--13-0!/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/src/utils/authFilter.js","dependencies":[{"path":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/src/utils/authFilter.js","mtime":1571018558910},{"path":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.string.includes\";\nimport \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es7.symbol.async-iterator\";\nimport \"core-js/modules/es6.symbol\";\nimport \"core-js/modules/web.dom.iterable\";\nimport { USER_AUTH, SYS_BUTTON_AUTH } from \"@/store/mutation-types\";\nexport function disabledAuthFilter(code, formData) {\n  if (nodeDisabledAuth(code, formData)) {\n    return true;\n  } else {\n    return globalDisabledAuth(code);\n  }\n}\n\nfunction nodeDisabledAuth(code, formData) {\n  console.log(\"页面权限禁用--NODE--开始\");\n  var permissionList = [];\n\n  try {\n    var obj = formData; //console.log(\"页面权限禁用--NODE--开始\",obj);\n\n    if (obj) {\n      var bpmList = obj.permissionList;\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = bpmList[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var bpm = _step.value;\n\n          if (bpm.type == '2') {\n            permissionList.push(bpm);\n          }\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return != null) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n    }\n  } catch (e) {//console.log(\"页面权限异常----\", e);\n  }\n\n  if (permissionList === null || permissionList === \"\" || permissionList === undefined || permissionList.length <= 0) {\n    return false;\n  }\n\n  var permissions = [];\n\n  for (var _i = 0, _permissionList = permissionList; _i < _permissionList.length; _i++) {\n    var item = _permissionList[_i];\n\n    if (item.type == '2') {\n      permissions.push(item.action);\n    }\n  } //console.log(\"页面权限----\"+code);\n\n\n  if (!permissions.includes(code)) {\n    return false;\n  } else {\n    for (var _i2 = 0, _permissionList2 = permissionList; _i2 < _permissionList2.length; _i2++) {\n      var item2 = _permissionList2[_i2];\n\n      if (code === item2.action) {\n        console.log(\"页面权限禁用--NODE--生效\");\n        return true;\n      }\n    }\n  }\n\n  return false;\n}\n\nfunction globalDisabledAuth(code) {\n  console.log(\"页面禁用权限--Global--开始\");\n  var permissionList = [];\n  var allPermissionList = []; //let authList = Vue.ls.get(USER_AUTH);\n\n  var authList = JSON.parse(sessionStorage.getItem(USER_AUTH) || \"[]\");\n  var _iteratorNormalCompletion2 = true;\n  var _didIteratorError2 = false;\n  var _iteratorError2 = undefined;\n\n  try {\n    for (var _iterator2 = authList[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n      var auth = _step2.value;\n\n      if (auth.type == '2') {\n        permissionList.push(auth);\n      }\n    } //console.log(\"页面禁用权限--Global--\",sessionStorage.getItem(SYS_BUTTON_AUTH));\n\n  } catch (err) {\n    _didIteratorError2 = true;\n    _iteratorError2 = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion2 && _iterator2.return != null) {\n        _iterator2.return();\n      }\n    } finally {\n      if (_didIteratorError2) {\n        throw _iteratorError2;\n      }\n    }\n  }\n\n  var allAuthList = JSON.parse(sessionStorage.getItem(SYS_BUTTON_AUTH) || \"[]\");\n  var _iteratorNormalCompletion3 = true;\n  var _didIteratorError3 = false;\n  var _iteratorError3 = undefined;\n\n  try {\n    for (var _iterator3 = allAuthList[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n      var gauth = _step3.value;\n\n      if (gauth.type == '2') {\n        allPermissionList.push(gauth);\n      }\n    } //设置全局配置是否有命中\n\n  } catch (err) {\n    _didIteratorError3 = true;\n    _iteratorError3 = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion3 && _iterator3.return != null) {\n        _iterator3.return();\n      }\n    } finally {\n      if (_didIteratorError3) {\n        throw _iteratorError3;\n      }\n    }\n  }\n\n  var gFlag = false; //禁用命中\n\n  var invalidFlag = false; //无效命中\n\n  if (allPermissionList != null && allPermissionList != \"\" && allPermissionList != undefined && allPermissionList.length > 0) {\n    for (var _i3 = 0, _allPermissionList = allPermissionList; _i3 < _allPermissionList.length; _i3++) {\n      var itemG = _allPermissionList[_i3];\n\n      if (code === itemG.action) {\n        if (itemG.status == '0') {\n          invalidFlag = true;\n          break;\n        } else {\n          gFlag = true;\n          break;\n        }\n      }\n    }\n  }\n\n  if (invalidFlag) {\n    return false;\n  }\n\n  if (permissionList === null || permissionList === \"\" || permissionList === undefined || permissionList.length <= 0) {\n    return gFlag;\n  }\n\n  var permissions = [];\n\n  for (var _i4 = 0, _permissionList3 = permissionList; _i4 < _permissionList3.length; _i4++) {\n    var item = _permissionList3[_i4];\n\n    if (item.type == '2') {\n      permissions.push(item.action);\n    }\n  } //console.log(\"页面禁用权限----\"+code);\n\n\n  if (!permissions.includes(code)) {\n    return gFlag;\n  } else {\n    for (var _i5 = 0, _permissionList4 = permissionList; _i5 < _permissionList4.length; _i5++) {\n      var item2 = _permissionList4[_i5];\n\n      if (code === item2.action) {\n        console.log(\"页面权限解除禁用--Global--生效\");\n        gFlag = false;\n      }\n    }\n\n    return gFlag;\n  }\n}\n\nexport function colAuthFilter(columns, pre) {\n  var authList = getNoAuthCols(pre);\n  var cols = columns.filter(function (item) {\n    if (hasColoum(item, authList)) {\n      return true;\n    }\n\n    return false;\n  });\n  return cols;\n}\n\nfunction hasColoum(item, authList) {\n  if (authList.includes(item.dataIndex)) {\n    return false;\n  }\n\n  return true;\n} //权限无效时不做控制，有效时控制，只能控制 显示不显示\n//根据授权码前缀获取未授权的列信息\n\n\nfunction getNoAuthCols(pre) {\n  var permissionList = [];\n  var allPermissionList = []; //let authList = Vue.ls.get(USER_AUTH);\n\n  var authList = JSON.parse(sessionStorage.getItem(USER_AUTH) || \"[]\");\n  var _iteratorNormalCompletion4 = true;\n  var _didIteratorError4 = false;\n  var _iteratorError4 = undefined;\n\n  try {\n    for (var _iterator4 = authList[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n      var auth = _step4.value;\n\n      //显示策略，有效状态\n      if (auth.type == '1' && startWith(auth.action, pre)) {\n        permissionList.push(substrPre(auth.action, pre));\n      }\n    } //console.log(\"页面禁用权限--Global--\",sessionStorage.getItem(SYS_BUTTON_AUTH));\n\n  } catch (err) {\n    _didIteratorError4 = true;\n    _iteratorError4 = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion4 && _iterator4.return != null) {\n        _iterator4.return();\n      }\n    } finally {\n      if (_didIteratorError4) {\n        throw _iteratorError4;\n      }\n    }\n  }\n\n  var allAuthList = JSON.parse(sessionStorage.getItem(SYS_BUTTON_AUTH) || \"[]\");\n  var _iteratorNormalCompletion5 = true;\n  var _didIteratorError5 = false;\n  var _iteratorError5 = undefined;\n\n  try {\n    for (var _iterator5 = allAuthList[Symbol.iterator](), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {\n      var gauth = _step5.value;\n\n      //显示策略，有效状态\n      if (gauth.type == '1' && gauth.status == '1' && startWith(gauth.action, pre)) {\n        allPermissionList.push(substrPre(gauth.action, pre));\n      }\n    }\n  } catch (err) {\n    _didIteratorError5 = true;\n    _iteratorError5 = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion5 && _iterator5.return != null) {\n        _iterator5.return();\n      }\n    } finally {\n      if (_didIteratorError5) {\n        throw _iteratorError5;\n      }\n    }\n  }\n\n  var cols = allPermissionList.filter(function (item) {\n    if (permissionList.includes(item)) {\n      return false;\n    }\n\n    return true;\n  });\n  return cols;\n}\n\nfunction startWith(str, pre) {\n  if (pre == null || pre == \"\" || str == null || str == \"\" || str.length == 0 || pre.length > str.length) return false;\n  if (str.substr(0, pre.length) == pre) return true;else return false;\n}\n\nfunction substrPre(str, pre) {\n  return str.substr(pre.length);\n}",null]}