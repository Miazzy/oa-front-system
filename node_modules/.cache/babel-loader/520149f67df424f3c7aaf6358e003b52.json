{"remainingRequest":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/src/components/layouts/TabLayout.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/src/components/layouts/TabLayout.vue","mtime":1571018558902},{"path":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _toConsumableArray from \"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport GlobalLayout from '@/components/page/GlobalLayout';\nimport Contextmenu from '@/components/menu/Contextmenu';\nimport { mixin, mixinDevice } from '@/utils/mixin.js';\nvar indexKey = '/dashboard/analysis';\nexport default {\n  name: 'TabLayout',\n  components: {\n    GlobalLayout: GlobalLayout,\n    Contextmenu: Contextmenu\n  },\n  mixins: [mixin, mixinDevice],\n  data: function data() {\n    return {\n      pageList: [],\n      linkList: [],\n      activePage: '',\n      menuVisible: false,\n      menuItemList: [{\n        key: '1',\n        icon: 'arrow-left',\n        text: '关闭左侧'\n      }, {\n        key: '2',\n        icon: 'arrow-right',\n        text: '关闭右侧'\n      }, {\n        key: '3',\n        icon: 'close',\n        text: '关闭其它'\n      }]\n    };\n  },\n  computed: {\n    multipage: function multipage() {\n      //判断如果是手机模式，自动切换为单页面模式\n      if (this.isMobile()) {\n        return false;\n      } else {\n        return this.$store.state.app.multipage;\n      }\n    }\n  },\n  created: function created() {\n    if (this.$route.path != indexKey) {\n      this.pageList.push({\n        name: 'dashboard-analysis',\n        path: indexKey,\n        fullPath: indexKey,\n        meta: {\n          icon: 'dashboard',\n          title: '首页'\n        }\n      });\n      this.linkList.push(indexKey);\n    }\n\n    this.pageList.push(this.$route);\n    this.linkList.push(this.$route.fullPath);\n    this.activePage = this.$route.fullPath;\n  },\n  watch: {\n    '$route': function $route(newRoute) {\n      this.activePage = newRoute.fullPath;\n\n      if (!this.multipage) {\n        this.linkList = [newRoute.fullPath];\n        this.pageList = [Object.assign({}, newRoute)];\n      } else if (this.linkList.indexOf(newRoute.fullPath) < 0) {\n        this.linkList.push(newRoute.fullPath);\n        this.pageList.push(Object.assign({}, newRoute));\n      } else if (this.linkList.indexOf(newRoute.fullPath) >= 0) {\n        var oldIndex = this.linkList.indexOf(newRoute.fullPath);\n        var oldPositionRoute = this.pageList[oldIndex];\n        this.pageList.splice(oldIndex, 1, Object.assign({}, newRoute, {\n          meta: oldPositionRoute.meta\n        }));\n      }\n    },\n    'activePage': function activePage(key) {\n      var index = this.linkList.lastIndexOf(key);\n      var waitRouter = this.pageList[index];\n      this.$router.push(Object.assign({}, waitRouter));\n    },\n    'multipage': function multipage(newVal) {\n      if (!newVal) {\n        this.linkList = [this.$route.fullPath];\n        this.pageList = [this.$route];\n      }\n    }\n  },\n  methods: {\n    changePage: function changePage(key) {\n      this.activePage = key;\n    },\n    editPage: function editPage(key, action) {\n      this[action](key);\n    },\n    remove: function remove(key) {\n      if (key == indexKey) {\n        this.$message.warning('首页不能关闭!');\n        return;\n      }\n\n      if (this.pageList.length === 1) {\n        this.$message.warning('这是最后一页，不能再关闭了啦');\n        return;\n      }\n\n      this.pageList = this.pageList.filter(function (item) {\n        return item.fullPath !== key;\n      });\n      var index = this.linkList.indexOf(key);\n      this.linkList = this.linkList.filter(function (item) {\n        return item !== key;\n      });\n      index = index >= this.linkList.length ? this.linkList.length - 1 : index;\n      this.activePage = this.linkList[index];\n    },\n    onContextmenu: function onContextmenu(e) {\n      var pagekey = this.getPageKey(e.target);\n\n      if (pagekey !== null) {\n        e.preventDefault();\n        this.menuVisible = true;\n      }\n    },\n    getPageKey: function getPageKey(target, depth) {\n      depth = depth || 0;\n\n      if (depth > 2) {\n        return null;\n      }\n\n      var pageKey = target.getAttribute('pagekey');\n      pageKey = pageKey || (target.previousElementSibling ? target.previousElementSibling.getAttribute('pagekey') : null);\n      return pageKey || (target.firstElementChild ? this.getPageKey(target.firstElementChild, ++depth) : null);\n    },\n    onMenuSelect: function onMenuSelect(key, target) {\n      var pageKey = this.getPageKey(target);\n\n      switch (key) {\n        case '1':\n          this.closeLeft(pageKey);\n          break;\n\n        case '2':\n          this.closeRight(pageKey);\n          break;\n\n        case '3':\n          this.closeOthers(pageKey);\n          break;\n\n        default:\n          break;\n      }\n    },\n    closeOthers: function closeOthers(pageKey) {\n      var index = this.linkList.indexOf(pageKey);\n\n      if (pageKey == indexKey) {\n        this.linkList = this.linkList.slice(index, index + 1);\n        this.pageList = this.pageList.slice(index, index + 1);\n        this.activePage = this.linkList[0];\n      } else {\n        var indexContent = this.pageList.slice(0, 1)[0];\n        this.linkList = this.linkList.slice(index, index + 1);\n        this.pageList = this.pageList.slice(index, index + 1);\n        this.linkList.unshift(indexKey);\n        this.pageList.unshift(indexContent);\n        this.activePage = this.linkList[1];\n      }\n    },\n    closeLeft: function closeLeft(pageKey) {\n      if (pageKey == indexKey) {\n        return;\n      }\n\n      var tempList = _toConsumableArray(this.pageList);\n\n      var indexContent = tempList.slice(0, 1)[0];\n      var index = this.linkList.indexOf(pageKey);\n      this.linkList = this.linkList.slice(index);\n      this.pageList = this.pageList.slice(index);\n      this.linkList.unshift(indexKey);\n      this.pageList.unshift(indexContent);\n\n      if (this.linkList.indexOf(this.activePage) < 0) {\n        this.activePage = this.linkList[0];\n      }\n    },\n    closeRight: function closeRight(pageKey) {\n      var index = this.linkList.indexOf(pageKey);\n      this.linkList = this.linkList.slice(0, index + 1);\n      this.pageList = this.pageList.slice(0, index + 1);\n\n      if (this.linkList.indexOf(this.activePage < 0)) {\n        this.activePage = this.linkList[this.linkList.length - 1];\n      }\n    },\n    //update-begin-author:taoyan date:20190430 for:动态路由title显示配置的菜单title而不是其对应路由的title\n    dynamicRouterShow: function dynamicRouterShow(key, title) {\n      var keyIndex = this.linkList.indexOf(key);\n\n      if (keyIndex >= 0) {\n        var currRouter = this.pageList[keyIndex];\n        var meta = Object.assign({}, currRouter.meta, {\n          title: title\n        });\n        this.pageList.splice(keyIndex, 1, Object.assign({}, currRouter, {\n          meta: meta\n        }));\n      }\n    } //update-end-author:taoyan date:20190430 for:动态路由title显示配置的菜单title而不是其对应路由的title\n\n  }\n};",{"version":3,"sources":["TabLayout.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <global-layout @dynamicRouterShow=\"dynamicRouterShow\">\n    <contextmenu :itemList=\"menuItemList\" :visible.sync=\"menuVisible\" @select=\"onMenuSelect\"/>\n    <a-tabs\n      @contextmenu.native=\"e => onContextmenu(e)\"\n      v-if=\"multipage\"\n      :active-key=\"activePage\"\n      class=\"tab-layout-tabs\"\n      style=\"height:52px\"\n      :hide-add=\"true\"\n      type=\"editable-card\"\n      @change=\"changePage\"\n      @edit=\"editPage\">\n      <a-tab-pane :id=\"page.fullPath\" :key=\"page.fullPath\" v-for=\"page in pageList\">\n        <span slot=\"tab\" :pagekey=\"page.fullPath\">{{ page.meta.title }}</span>\n      </a-tab-pane>\n    </a-tabs>\n    <div style=\"margin: 12px 12px 0;\">\n      <transition name=\"page-toggle\">\n        <keep-alive v-if=\"multipage\">\n          <router-view/>\n        </keep-alive>\n        <router-view v-else/>\n      </transition>\n    </div>\n  </global-layout>\n</template>\n\n<script>\n  import GlobalLayout from '@/components/page/GlobalLayout'\n  import Contextmenu from '@/components/menu/Contextmenu'\n  import { mixin, mixinDevice } from '@/utils/mixin.js'\n\n  const indexKey = '/dashboard/analysis'\n\n  export default {\n    name: 'TabLayout',\n    components: {\n      GlobalLayout,\n      Contextmenu\n    },\n    mixins: [mixin, mixinDevice],\n    data() {\n      return {\n        pageList: [],\n        linkList: [],\n        activePage: '',\n        menuVisible: false,\n        menuItemList: [\n          { key: '1', icon: 'arrow-left', text: '关闭左侧' },\n          { key: '2', icon: 'arrow-right', text: '关闭右侧' },\n          { key: '3', icon: 'close', text: '关闭其它' }\n        ]\n      }\n    },\n    computed: {\n      multipage() {\n        //判断如果是手机模式，自动切换为单页面模式\n        if (this.isMobile()) {\n          return false\n        } else {\n          return this.$store.state.app.multipage\n        }\n      }\n    },\n    created() {\n      if (this.$route.path != indexKey) {\n        this.pageList.push({\n          name: 'dashboard-analysis',\n          path: indexKey,\n          fullPath: indexKey,\n          meta: {\n            icon: 'dashboard',\n            title: '首页'\n          }\n        })\n        this.linkList.push(indexKey)\n      }\n      this.pageList.push(this.$route)\n      this.linkList.push(this.$route.fullPath)\n      this.activePage = this.$route.fullPath\n    },\n    watch: {\n      '$route': function(newRoute) {\n        this.activePage = newRoute.fullPath\n        if (!this.multipage) {\n          this.linkList = [newRoute.fullPath]\n          this.pageList = [Object.assign({},newRoute)]\n        } else if (this.linkList.indexOf(newRoute.fullPath) < 0) {\n          this.linkList.push(newRoute.fullPath)\n          this.pageList.push(Object.assign({},newRoute))\n        } else if (this.linkList.indexOf(newRoute.fullPath) >= 0) {\n          let oldIndex = this.linkList.indexOf(newRoute.fullPath)\n          let oldPositionRoute = this.pageList[oldIndex]\n          this.pageList.splice(oldIndex, 1, Object.assign({},newRoute,{meta:oldPositionRoute.meta}))\n        }\n      },\n      'activePage': function(key) {\n        let index = this.linkList.lastIndexOf(key)\n        let waitRouter = this.pageList[index]\n        this.$router.push(Object.assign({},waitRouter));\n      },\n      'multipage': function(newVal) {\n        if (!newVal) {\n          this.linkList = [this.$route.fullPath]\n          this.pageList = [this.$route]\n        }\n      }\n    },\n    methods: {\n      changePage(key) {\n        this.activePage = key\n      },\n      editPage(key, action) {\n        this[action](key)\n      },\n      remove(key) {\n        if (key == indexKey) {\n          this.$message.warning('首页不能关闭!')\n          return\n        }\n        if (this.pageList.length === 1) {\n          this.$message.warning('这是最后一页，不能再关闭了啦')\n          return\n        }\n        this.pageList = this.pageList.filter(item => item.fullPath !== key)\n        let index = this.linkList.indexOf(key)\n        this.linkList = this.linkList.filter(item => item !== key)\n        index = index >= this.linkList.length ? this.linkList.length - 1 : index\n        this.activePage = this.linkList[index]\n      },\n      onContextmenu(e) {\n        const pagekey = this.getPageKey(e.target)\n        if (pagekey !== null) {\n          e.preventDefault()\n          this.menuVisible = true\n        }\n      },\n      getPageKey(target, depth) {\n        depth = depth || 0\n        if (depth > 2) {\n          return null\n        }\n        let pageKey = target.getAttribute('pagekey')\n        pageKey = pageKey || (target.previousElementSibling ? target.previousElementSibling.getAttribute('pagekey') : null)\n        return pageKey || (target.firstElementChild ? this.getPageKey(target.firstElementChild, ++depth) : null)\n      },\n      onMenuSelect(key, target) {\n        let pageKey = this.getPageKey(target)\n        switch (key) {\n          case '1':\n            this.closeLeft(pageKey)\n            break\n          case '2':\n            this.closeRight(pageKey)\n            break\n          case '3':\n            this.closeOthers(pageKey)\n            break\n          default:\n            break\n        }\n      },\n      closeOthers(pageKey) {\n        let index = this.linkList.indexOf(pageKey)\n        if (pageKey == indexKey) {\n          this.linkList = this.linkList.slice(index, index + 1)\n          this.pageList = this.pageList.slice(index, index + 1)\n          this.activePage = this.linkList[0]\n        } else {\n          let indexContent = this.pageList.slice(0, 1)[0]\n          this.linkList = this.linkList.slice(index, index + 1)\n          this.pageList = this.pageList.slice(index, index + 1)\n          this.linkList.unshift(indexKey)\n          this.pageList.unshift(indexContent)\n          this.activePage = this.linkList[1]\n        }\n      },\n      closeLeft(pageKey) {\n        if (pageKey == indexKey) {\n          return\n        }\n        let tempList = [...this.pageList]\n        let indexContent = tempList.slice(0, 1)[0]\n        let index = this.linkList.indexOf(pageKey)\n        this.linkList = this.linkList.slice(index)\n        this.pageList = this.pageList.slice(index)\n        this.linkList.unshift(indexKey)\n        this.pageList.unshift(indexContent)\n        if (this.linkList.indexOf(this.activePage) < 0) {\n          this.activePage = this.linkList[0]\n        }\n      },\n      closeRight(pageKey) {\n        let index = this.linkList.indexOf(pageKey)\n        this.linkList = this.linkList.slice(0, index + 1)\n        this.pageList = this.pageList.slice(0, index + 1)\n        if (this.linkList.indexOf(this.activePage < 0)) {\n          this.activePage = this.linkList[this.linkList.length - 1]\n        }\n      },\n      //update-begin-author:taoyan date:20190430 for:动态路由title显示配置的菜单title而不是其对应路由的title\n      dynamicRouterShow(key,title){\n        let keyIndex = this.linkList.indexOf(key)\n        if(keyIndex>=0){\n          let currRouter = this.pageList[keyIndex]\n          let meta = Object.assign({},currRouter.meta,{title:title})\n          this.pageList.splice(keyIndex, 1, Object.assign({},currRouter,{meta:meta}))\n        }\n      }\n      //update-end-author:taoyan date:20190430 for:动态路由title显示配置的菜单title而不是其对应路由的title\n    }\n  }\n</script>\n\n<style lang=\"scss\">\n\n  /*\n * The following styles are auto-applied to elements with\n * transition=\"page-transition\" when their visibility is toggled\n * by Vue.js.\n *\n * You can easily play with the page transition by editing\n * these styles.\n */\n\n  .page-transition-enter {\n    opacity: 0;\n  }\n\n  .page-transition-leave-active {\n    opacity: 0;\n  }\n\n  .page-transition-enter .page-transition-container,\n  .page-transition-leave-active .page-transition-container {\n    -webkit-transform: scale(1.1);\n    transform: scale(1.1);\n  }\n\n  /*美化弹出Tab样式*/\n  .ant-tabs-nav-container {\n    margin-top: 4px;\n  }\n\n  /* 修改 ant-tabs 样式 */\n  .tab-layout-tabs.ant-tabs {\n    border-bottom: 1px solid #ccc;\n    border-left: 1px solid #ccc;\n    background-color: white;\n    padding: 0 20px;\n\n    .ant-tabs-bar {\n      margin: 4px 0 0;\n      border: none;\n    }\n\n  }\n\n  .ant-tabs {\n\n    &.ant-tabs-card .ant-tabs-tab {\n\n      padding: 0 24px !important;\n      background-color: white !important;\n      margin-right: 10px !important;\n\n      .ant-tabs-close-x {\n        width: 12px !important;\n        height: 12px !important;\n        opacity: 0 !important;\n        cursor: pointer !important;\n        font-size: 12px !important;\n        margin: 0 !important;\n        position: absolute;\n        top: 36%;\n        right: 6px;\n      }\n\n      &:hover .ant-tabs-close-x {\n        opacity: 1 !important;\n      }\n\n    }\n\n  }\n\n  .ant-tabs.ant-tabs-card > .ant-tabs-bar {\n    .ant-tabs-tab {\n      border: none !important;\n      border-bottom: 1px solid transparent !important;\n    }\n    .ant-tabs-tab-active {\n      border-color: #1890ff !important;\n    }\n  }\n\n\n</style>"],"sourceRoot":"src/components/layouts"}]}