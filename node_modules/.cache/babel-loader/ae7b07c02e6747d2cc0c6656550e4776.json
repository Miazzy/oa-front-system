{"remainingRequest":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/thread-loader/dist/cjs.js!/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/eslint-loader/index.js??ref--13-0!/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/src/store/modules/permission.js","dependencies":[{"path":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/src/store/modules/permission.js","mtime":1571018558909},{"path":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import { asyncRouterMap, constantRouterMap } from \"@/config/router.config\";\n/**\n * 过滤账户是否拥有某一个权限，并将菜单从加载列表移除\n *\n * @param permission\n * @param route\n * @returns {boolean}\n */\n\nfunction hasPermission(permission, route) {\n  if (route.meta && route.meta.permission) {\n    var flag = -1;\n\n    for (var i = 0, len = permission.length; i < len; i++) {\n      flag = route.meta.permission.indexOf(permission[i]);\n\n      if (flag >= 0) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  return true;\n}\n/**\n * 单账户多角色时，使用该方法可过滤角色不存在的菜单\n *\n * @param roles\n * @param route\n * @returns {*}\n */\n// eslint-disable-next-line\n\n\nfunction hasRole(roles, route) {\n  if (route.meta && route.meta.roles) {\n    return route.meta.roles.indexOf(roles.id);\n  } else {\n    return true;\n  }\n}\n\nfunction filterAsyncRouter(routerMap, roles) {\n  var accessedRouters = routerMap.filter(function (route) {\n    if (hasPermission(roles.permissionList, route)) {\n      if (route.children && route.children.length) {\n        route.children = filterAsyncRouter(route.children, roles);\n      }\n\n      return true;\n    }\n\n    return false;\n  });\n  return accessedRouters;\n}\n\nvar permission = {\n  state: {\n    routers: constantRouterMap,\n    addRouters: []\n  },\n  mutations: {\n    SET_ROUTERS: function SET_ROUTERS(state, data) {\n      state.addRouters = data;\n      state.routers = constantRouterMap.concat(data);\n      console.log('-----mutations---SET_ROUTERS----', data);\n    }\n  },\n  actions: {\n    GenerateRoutes: function GenerateRoutes(_ref, data) {\n      var commit = _ref.commit;\n      return new Promise(function (resolve) {\n        var roles = data.roles;\n        console.log('-----mutations---data----', data);\n        var accessedRouters;\n        accessedRouters = filterAsyncRouter(asyncRouterMap, roles);\n        console.log('-----mutations---accessedRouters----', accessedRouters);\n        commit('SET_ROUTERS', accessedRouters);\n        resolve();\n      });\n    },\n    // 动态添加主界面路由，需要缓存\n    UpdateAppRouter: function UpdateAppRouter(_ref2, routes) {\n      var commit = _ref2.commit;\n      return new Promise(function (resolve) {\n        //const [ roles ] = routes.constRoutes\n        var routelist = routes.constRoutes;\n        commit('SET_ROUTERS', routelist);\n        resolve();\n      });\n    }\n  }\n};\nexport default permission;",null]}