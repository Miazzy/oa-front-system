{"remainingRequest":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/src/views/jeecg/report/ArchivesStatisticst.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/src/views/jeecg/report/ArchivesStatisticst.vue","mtime":1571018558924},{"path":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/cache-loader/dist/cjs.js","mtime":1565525385854},{"path":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/thread-loader/dist/cjs.js","mtime":1565525386522},{"path":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/babel-loader/lib/index.js","mtime":1565533683804},{"path":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/cache-loader/dist/cjs.js","mtime":1565525385854},{"path":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/vue-loader/lib/index.js","mtime":1571018827562}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport Bar from '@/components/chart/Bar'\nimport Pie from '@/components/chart/Pie'\nimport ACol from 'ant-design-vue/es/grid/Col'\nimport { getAction } from '@/api/manage'\n\nexport default {\n  name: 'ArchivesStatisticst',\n  components: {\n    ACol,\n    Bar,\n    Pie\n  },\n  data() {\n    return {\n      description: '档案统计页面',\n      // 查询条件\n      queryParam: {},\n      // 数据集\n      countSource: [],\n      // 柱状图\n      barType: 'year',\n      barDate: ['month', 'month'],\n      barValue: [],\n      // 饼状图\n      pieType: 'year',\n      pieDate: ['month', 'month'],\n      pieValue: [],\n      // 统计图类型\n      tabStatus:\"bar\",\n      url: {\n        getYearCountInfo: \"/api/report/getYearCountInfo\",\n        getMonthCountInfo:\"/api/report/getMonthCountInfo\",\n        getCntrNoCountInfo:\"/api/report/getCntrNoCountInfo\",\n        getCabinetCountInfo:\"/api/report/getCabinetCountInfo\",\n      },\n    }\n  },\n  created() {\n    let url = this.url.getYearCountInfo;\n    this.loadDate(url,'year',{});\n  },\n  methods: {\n    loadDate(url,type,param) {\n      getAction(url,param,'get').then((res) => {\n        if (res.success) {\n          this.countSource = [];\n          if(type === 'year'){\n            this.getYearCountSource(res.result);\n          }\n          if(type === 'month'){\n            this.getMonthCountSource(res.result);\n          }\n          if(type === 'category'){\n            this.getCategoryCountSource(res.result);\n          }\n          if(type === 'cabinet'){\n            this.getCabinetCountSource(res.result);\n          }\n        }else{\n          var that=this;\n          that.$message.warning(res.message);\n        }\n      })\n    },\n    getYearCountSource(data){\n      for (let i = 0; i < data.length; i++) {\n        if(this.tabStatus === \"bar\"){\n          this.countSource.push({\n            x: `${data[i].year}年`,\n            y: data[i].yearcount\n          })\n        }else{\n          this.countSource.push({\n            item: `${data[i].year}年`,\n            count:data[i].yearcount\n          })\n        }\n      }\n    },\n    getMonthCountSource(data){\n      for (let i = 0; i < data.length; i++) {\n        if(this.tabStatus === \"bar\"){\n          this.countSource.push({\n            x: data[i].month,\n            y: data[i].monthcount\n          })\n        }else{\n          this.countSource.push({\n            item: data[i].month,\n            count:data[i].monthcount\n          })\n        }\n      }\n    },\n    getCategoryCountSource(data){\n      for (let i = 0; i < data.length; i++) {\n        if(this.tabStatus ===\"bar\"){\n          this.countSource.push({\n            x: data[i].classifyname,\n            y: data[i].cntrnocount\n          })\n        }else{\n          this.countSource.push({\n            item: data[i].classifyname,\n            count:data[i].cntrnocount\n          })\n        }\n      }\n    },\n    getCabinetCountSource(data){\n      for (let i = 0; i < data.length; i++) {\n        if(this.tabStatus === \"bar\"){\n          this.countSource.push({\n            x: data[i].cabinetname,\n            y: data[i].cabinetcocunt\n          })\n        }else{\n          this.countSource.push({\n            item: data[i].cabinetname,\n            count:data[i].cabinetcocunt\n          })\n        }\n      }\n    },\n    // 选择统计图类别\n    callback(key) {\n      if(key === \"1\"){\n        this.tabStatus = \"bar\";\n        this.queryDatebar();\n      }else{\n        this.tabStatus = \"pie\";\n        this.queryDatepie();\n      }\n    },\n    // 选择统计类别\n    statisticst(e) {\n      if(this.tabStatus === \"pie\"){\n        this.pieType = e.target.value;\n        this.queryDatepie();\n      }else{\n        this.barType = e.target.value;\n        this.queryDatebar();\n      }\n    },\n    // 按月份查询\n    queryDatebar(){\n      if(this.barValue.length>0){\n        this.getUrl(this.barType,{startTime:this.barValue[0]._d,endTime:this.barValue[1]._d});\n      }else{\n        this.getUrl(this.barType,{});\n      }\n    },\n    queryDatepie(){\n      if(this.pieValue.length>0){\n        this.getUrl(this.pieType,{startTime:this.pieValue[0]._d,endTime:this.pieValue[1]._d});\n      }else{\n        this.getUrl(this.pieType,{});\n      }\n    },\n    searchReset(){\n      console.log(this.tabStatus);\n      if(this.tabStatus === \"pie\"){\n        this.pieValue = [];\n      }else{\n        this.barValue = [];\n      }\n      this.getUrl(this.barType,{});\n    },\n    // 选择请求url\n    getUrl(type,param){\n      let url = \"\";\n      if(type === 'year'){\n        url = this.url.getYearCountInfo;\n      }\n      if(type === 'month'){\n        url = this.url.getMonthCountInfo;\n      }\n      if(type === 'category'){\n        url = this.url.getCntrNoCountInfo;\n      }\n      if(type === 'cabinet'){\n        url = this.url.getCabinetCountInfo;\n      }\n      this.loadDate(url,type,param);\n    },\n    // 选择月份日期\n    handleBarDate(value, mode) {\n      this.barValue = value\n      this.barDate = [\n        mode[0] === 'date' ? 'month' : mode[0],\n        mode[1] === 'date' ? 'month' : mode[1]\n      ]\n    },\n    handlePieDate(value, mode) {\n      this.pieValue = value\n      this.pieDate = [\n        mode[0] === 'date' ? 'month' : mode[0],\n        mode[1] === 'date' ? 'month' : mode[1]\n      ]\n    },\n  }\n}\n",null]}