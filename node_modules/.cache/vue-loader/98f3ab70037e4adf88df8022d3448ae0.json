{"remainingRequest":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/src/views/user/Step1.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/src/views/user/Step1.vue","mtime":1571018558938},{"path":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/cache-loader/dist/cjs.js","mtime":1565525385854},{"path":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/babel-loader/lib/index.js","mtime":1565533683804},{"path":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/cache-loader/dist/cjs.js","mtime":1565525385854},{"path":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/vue-loader/lib/index.js","mtime":1571018827562}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport JGraphicCode from '@/components/jeecg/JGraphicCode'\nimport { getAction } from  '@/api/manage'\nimport {checkOnlyUser } from '@/api/api'\nexport default {\n  name: \"Step1\",\n  components: {\n    JGraphicCode\n  },\n  data () {\n    return {\n      form: this.$form.createForm(this),\n      inputCodeContent: \"\",\n      inputCodeNull:true,\n      verifiedCode:\"\",\n      validatorRules: {\n        username:{rules: [{ required: false},{validator: this.validateInputUsername}]},\n        inputCode:{rules: [{ required: true, message: '请输入验证码!'},{validator: this.validateInputCode}]},\n      },\n\n    }\n  },\n  methods: {\n    nextStep () {\n      let that = this\n      this.form.validateFields((err, values) => {\n        if (!err){\n        var params={}\n        var reg=/^[1-9]\\d*$|^0$/;\n        var username=values.username;\n        if(reg.test(username)==true) {\n          params.phone=username;\n        }else{\n          params.username=username;\n        }\n          getAction(\"/sys/user/querySysUser\",params).then((res)=>{\n            if(res.success){\n          var userList={\n            username:res.result.username,\n            phone:res.result.phone\n          };\n           setTimeout(function () {\n            that.$emit('nextStep',userList)\n          })\n        }\n        });\n      }\n  })\n\n    },\n    validateInputCode(rule, value, callback){\n      if (!value || this.verifiedCode == this.inputCodeContent) {\n        callback();\n      } else {\n        callback(new Error(\"您输入的验证码不正确!\"));\n      }\n    },\n    inputCodeChange(e){\n      this.inputCodeContent = e.target.value;\n      console.log(this.inputCodeContent)\n      if(!e.target.value||0==e.target.value){\n        this.inputCodeNull=true\n      }else{\n        this.inputCodeContent = this.inputCodeContent.toLowerCase()\n        this.inputCodeNull=false\n      }\n    },\n    generateCode(value){\n      this.verifiedCode = value.toLowerCase();\n      console.log(this.verifiedCode);\n    },\n    validateInputUsername(rule, value, callback){\n      console.log(value);\n      var reg=/^[0-9]+.?[0-9]*/;\n      if(!value){\n        callback(\"请输入用户名和手机号！\");\n      }\n\n      //判断用户输入账号还是手机号码\n      if(reg.test(value)){\n        var params = {\n          phone : value,\n        };\n        checkOnlyUser(params).then((res) => {\n          if (res.success) {\n          callback(\"用户名不存在!\")\n        } else {\n          callback()\n        }\n      })\n      }else{\n        var params = {\n          username: value,\n        };\n        checkOnlyUser(params).then((res) => {\n          if (res.success) {\n            callback(\"用户名不存在!\")\n          } else {\n            callback()\n          }\n        })\n      }\n    },\n\n  }\n}\n",{"version":3,"sources":["Step1.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"Step1.vue","sourceRoot":"src/views/user","sourcesContent":["<template>\n  <div class=\"main\">\n\n    <a-form  style=\"max-width: 500px; margin: 40px auto 0;\" :form=\"form\">\n      <a-form-item>\n        <a-input\n          v-decorator=\"['username',validatorRules.username]\"\n          size=\"large\"\n          type=\"text\"\n          autocomplete=\"false\"\n          placeholder=\"请输入用户名或手机号\">\n          <a-icon slot=\"prefix\" type=\"lock\" :style=\"{ color: 'rgba(0,0,0,.25)' }\"/>\n        </a-input>\n      </a-form-item>\n      <a-row :gutter=\"0\">\n        <a-col :span=\"14\">\n          <a-form-item>\n            <a-input\n              v-decorator=\"['inputCode',validatorRules.inputCode]\"\n              size=\"large\"\n              type=\"text\"\n              @change=\"inputCodeChange\"\n              placeholder=\"请输入验证码\">\n              <a-icon slot=\"prefix\" v-if=\" inputCodeContent==verifiedCode \" type=\"smile\"\n                      :style=\"{ color: 'rgba(0,0,0,.25)' }\"/>\n              <a-icon slot=\"prefix\" v-else type=\"frown\" :style=\"{ color: 'rgba(0,0,0,.25)' }\"/>\n            </a-input>\n          </a-form-item>\n        </a-col>\n        <a-col :span=\"10\">\n          <j-graphic-code @success=\"generateCode\" style=\"float: right\"></j-graphic-code>\n        </a-col>\n      </a-row>\n      <a-form-item :wrapperCol=\"{span: 19, offset: 5}\">\n        <a-button type=\"primary\" @click=\"nextStep\">下一步</a-button>\n      </a-form-item>\n    </a-form>\n  </div>\n</template>\n\n<script>\n  import JGraphicCode from '@/components/jeecg/JGraphicCode'\n  import { getAction } from  '@/api/manage'\n  import {checkOnlyUser } from '@/api/api'\n  export default {\n    name: \"Step1\",\n    components: {\n      JGraphicCode\n    },\n    data () {\n      return {\n        form: this.$form.createForm(this),\n        inputCodeContent: \"\",\n        inputCodeNull:true,\n        verifiedCode:\"\",\n        validatorRules: {\n          username:{rules: [{ required: false},{validator: this.validateInputUsername}]},\n          inputCode:{rules: [{ required: true, message: '请输入验证码!'},{validator: this.validateInputCode}]},\n        },\n\n      }\n    },\n    methods: {\n      nextStep () {\n        let that = this\n        this.form.validateFields((err, values) => {\n          if (!err){\n          var params={}\n          var reg=/^[1-9]\\d*$|^0$/;\n          var username=values.username;\n          if(reg.test(username)==true) {\n            params.phone=username;\n          }else{\n            params.username=username;\n          }\n            getAction(\"/sys/user/querySysUser\",params).then((res)=>{\n              if(res.success){\n            var userList={\n              username:res.result.username,\n              phone:res.result.phone\n            };\n             setTimeout(function () {\n              that.$emit('nextStep',userList)\n            })\n          }\n          });\n        }\n    })\n\n      },\n      validateInputCode(rule, value, callback){\n        if (!value || this.verifiedCode == this.inputCodeContent) {\n          callback();\n        } else {\n          callback(new Error(\"您输入的验证码不正确!\"));\n        }\n      },\n      inputCodeChange(e){\n        this.inputCodeContent = e.target.value;\n        console.log(this.inputCodeContent)\n        if(!e.target.value||0==e.target.value){\n          this.inputCodeNull=true\n        }else{\n          this.inputCodeContent = this.inputCodeContent.toLowerCase()\n          this.inputCodeNull=false\n        }\n      },\n      generateCode(value){\n        this.verifiedCode = value.toLowerCase();\n        console.log(this.verifiedCode);\n      },\n      validateInputUsername(rule, value, callback){\n        console.log(value);\n        var reg=/^[0-9]+.?[0-9]*/;\n        if(!value){\n          callback(\"请输入用户名和手机号！\");\n        }\n\n        //判断用户输入账号还是手机号码\n        if(reg.test(value)){\n          var params = {\n            phone : value,\n          };\n          checkOnlyUser(params).then((res) => {\n            if (res.success) {\n            callback(\"用户名不存在!\")\n          } else {\n            callback()\n          }\n        })\n        }else{\n          var params = {\n            username: value,\n          };\n          checkOnlyUser(params).then((res) => {\n            if (res.success) {\n              callback(\"用户名不存在!\")\n            } else {\n              callback()\n            }\n          })\n        }\n      },\n\n    }\n  }\n</script>\n\n<style scoped>\n\n</style>"]}]}