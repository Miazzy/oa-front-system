{"remainingRequest":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/src/views/system/modules/DepartWindow.vue?vue&type=style&index=0&id=228f7c62&scoped=true&lang=css&","dependencies":[{"path":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/src/views/system/modules/DepartWindow.vue","mtime":1571018558934},{"path":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/css-loader/index.js","mtime":1571018832066},{"path":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1571018827562},{"path":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/postcss-loader/src/index.js","mtime":1565525386487},{"path":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/cache-loader/dist/cjs.js","mtime":1565525385854},{"path":"/Users/yunwisdom/Workspace/jeecg-boot/ant-design-vue-jeecg/node_modules/vue-loader/lib/index.js","mtime":1571018827562}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.ant-table-tbody .ant-table-row td{\n  padding-top:10px;\n  padding-bottom:10px;\n}\n",{"version":3,"sources":["DepartWindow.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+JA;AACA;AACA;AACA","file":"DepartWindow.vue","sourceRoot":"src/views/system/modules","sourcesContent":["<template>\n  <a-modal\n    :width=\"modalWidth\"\n    :visible=\"visible\"\n    title=\"部门搜索\"\n    :confirmLoading=\"confirmLoading\"\n    @ok=\"handleSubmit\"\n    @cancel=\"handleCancel\"\n    cancelText=\"关闭\"\n    wrapClassName=\"ant-modal-cust-warp\"\n    >\n    <!--部门树-->\n    <template>\n      <a-form :form=\"form\">\n      <a-form-item :labelCol=\"labelCol\" :wrapperCol=\"wrapperCol\" label=\"上级部门\">\n      <a-tree\n        multiple\n        treeCheckable=\"tree\"\n        checkable\n        :checkedKeys=\"checkedKeys\"\n        allowClear=\"true\"\n        :checkStrictly=\"true\"\n        @check=\"onCheck\"\n        :dropdownStyle=\"{maxHeight:'200px',overflow:'auto'}\"\n        :treeData=\"departTree\"\n        placeholder=\"请选择上级部门\"\n        >\n      </a-tree>\n      </a-form-item>\n      </a-form>\n    </template>\n  </a-modal>\n</template>\n\n<script>\n  import pick from 'lodash.pick'\n  import { getAction } from '@/api/manage'\n  import { queryIdTree } from '@/api/api'\n  import userModal from './UserModal'\n  export default {\n    name: \"DepartWindow\",\n    components: {\n      userModal,\n    },\n    data () {\n      return {\n        checkedKeys:[], // 存储选中的部门id\n        userId:\"\", // 存储用户id\n        model:{}, // 存储SysUserDepartsVO表\n        userDepartModel:{userId:'',departIdList:[]}, // 存储用户id一对多部门信息的对象\n        departList:[], // 存储部门信息\n        modalWidth:400,\n        departTree:[],\n        title:\"操作\",\n        visible: false,\n        labelCol: {\n          xs: { span: 24 },\n          sm: { span: 5 },\n        },\n        wrapperCol: {\n          xs: { span: 24 },\n          sm: { span: 16 },\n        },\n        confirmLoading: false,\n        headers:{},\n        form:this.$form.createForm(this),\n        url: {\n          userId:\"/sys/user/generateUserId\", // 引入生成添加用户情况下的url\n        },\n      }\n    },\n    methods: {\n      add (checkedDepartKeys,userId) {\n        this.checkedKeys = checkedDepartKeys;\n        this.userId = userId;\n        this.edit({});\n      },\n      edit (record) {\n        this.departList = [];\n        this.queryDepartTree();\n        this.form.resetFields();\n        this.visible = true;\n        this.model = Object.assign({}, record);\n        let filedsVal = pick(this.model,'id','userId','departIdList');\n        this.$nextTick(() => {\n          this.form.setFieldsValue(filedsVal);\n        });\n      },\n      close () {\n        this.$emit('close');\n        this.visible = false;\n        this.departList = [];\n        this.checkedKeys = [];\n      },\n      handleSubmit () {\n        const that = this;\n        // 触发表单验证\n        this.form.validateFields((err) => {\n          if (!err) {\n            that.confirmLoading = true;\n            if(this.userId == null){\n              getAction(this.url.userId).then((res)=>{\n                if(res.success){\n                  let formData = {userId:res.result,\n                  departIdList:this.departList}\n                  console.log(formData)\n                  that.$emit('ok', formData);\n                }\n              }).finally(() => {\n                that.departList = [];\n                that.confirmLoading = false;\n                that.close();\n              })\n            }else {\n              let formData = {userId:this.userId,\n                departIdList:this.departList}\n              console.log(formData)\n              that.departList = [];\n              that.$emit('ok', formData);\n              that.confirmLoading = false;\n              that.close();\n            }\n          }\n        })\n      },\n      handleCancel () {\n        this.close()\n      },\n\n      // 选择部门时作用的API\n      onCheck(checkedKeys, info){\n        this.departList = [];\n        this.checkedKeys = checkedKeys.checked;\n        let checkedNodes = info.checkedNodes;\n        for (let i = 0; i < checkedNodes.length; i++) {\n          let de = checkedNodes[i].data.props;\n          let depart = {key:\"\",value:\"\",title:\"\"};\n          depart.key = de.value;\n          depart.value = de.value;\n          depart.title = de.title;\n          this.departList.push(depart);\n        }\n        console.log('onCheck', checkedKeys, info);\n      },\n      queryDepartTree(){\n        queryIdTree().then((res)=>{\n          if(res.success){\n            this.departTree = res.result;\n          }\n        })\n      },\n      modalFormOk(){\n\n      }\n      },\n  }\n</script>\n\n<style scoped>\n  .ant-table-tbody .ant-table-row td{\n    padding-top:10px;\n    padding-bottom:10px;\n  }\n</style>"]}]}